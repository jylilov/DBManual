<html>
<head>
    <meta charset="utf-8">
</head>
<body>
    <h1>Простой оператор SELECT </h1>
    <p>
    	Оператор <b>SELECT</b> осуществляет выборку из базы данных и имеет наиболее сложную структуру среди всех операторов языка SQL. Практически любой пользователь баз данных в состоянии написать простейший оператор <b>SELECT</b> типа
    </p>
    <p><b>SELECT * FROM PC;</b></p>
    <p>
    	который осуществляет выборку всех записей из объекта БД табличного типа с именем РС. При этом столбцы и строки результирующего набора не упорядочены. Чтобы упорядочить поля результирующего набора, их следует перечислить через запятую в нужном порядке после слова <b>SELECT</b>:
   	</p>
    <p>
    	<b>SELECT price, speed, hd, ram, cd, model, code FROM PC;</b>
	</p>
	<p>
		Ниже приводится результат выполнения этого запроса.
	</p>
	<p>
		<table border="1">
			<thead>
				<tr>
					<th>price</th>
					<th>speed</th>
					<th>hd</th>
					<th>ram</th>
					<th>cd</th>
					<th>model</th>
					<th>code</th>
				</tr>
			</thead>
			<tbody>
				<tr>
				 <td>600    </td> <td>500    </td> <td>5    </td> <td>64    </td> <td>12x    </td> <td>1232    </td> <td>1</td>
				</tr>
				<tr>
				 <td>850    </td> <td>750    </td> <td>14    </td> <td>128    </td> <td>40x    </td> <td>1121    </td> <td>2</td>
				</tr>
				<tr>
				 <td>600    </td> <td>500    </td> <td>5    </td> <td>64    </td> <td>12x    </td> <td>1233    </td> <td>3</td>
				</tr>
				<tr>
				 <td>850    </td> <td>600    </td> <td>14    </td> <td>128    </td> <td>40x    </td> <td>1121    </td> <td>4</td>
				</tr>
				<tr>
				 <td>850    </td> <td>600    </td> <td>8    </td> <td>128    </td> <td>40x    </td> <td>1121    </td> <td>5</td>
				</tr>
				<tr>
				 <td>950    </td> <td>750    </td> <td>20    </td> <td>128    </td> <td>50x    </td> <td>1233    </td> <td>6</td>
				</tr>
				<tr>
				 <td>400    </td> <td>500    </td> <td>10    </td> <td>32    </td> <td>12x    </td> <td>1232    </td> <td>7</td>
				</tr>
				<tr>
				 <td>350    </td> <td>450    </td> <td>8    </td> <td>64    </td> <td>24x    </td> <td>1232    </td> <td>8</td>
				</tr>
				<tr>
				 <td>350    </td> <td>450    </td> <td>10    </td> <td>32    </td> <td>24x    </td> <td>1232    </td> <td>9</td>
				</tr>
				<tr>
				 <td>350    </td> <td>500    </td> <td>10    </td> <td>32    </td> <td>12x    </td> <td>1260    </td> <td>10</td>
				</tr>
				<tr>
				 <td>980    </td> <td>900    </td> <td>40    </td> <td>128    </td> <td>40x    </td> <td>1233    </td> <td>11</td>
				</tr>
			</tbody>
		</table>
	</p>
	<p>
		Вертикальную проекцию таблицы РС можно получить, если перечислить только необходимые поля. Например, чтобы получить информацию только о частоте процессора и объеме оперативной памяти компьютеров, следует выполнить запрос:
	</p>
	<p>
		<b>SELECT speed, ram FROM PC;</b>
	</p>
	<p>
		который вернет следующие данные:
	</p>
	<p>
		<table border="1">
			<thead>
				<tr>
					<th>speed</th>
					<th>ram</th>
				</tr>
			</thead>
			<tbody>
				<tr>
				 <td>500    </td> <td>64</td>
				</tr>
				<tr>
				 <td>750    </td> <td>128</td>
				</tr>
				<tr>
				 <td>500    </td> <td>64</td>
				</tr>
				<tr>
				 <td>600    </td> <td>128</td>
				</tr>
				<tr>
				 <td>600    </td> <td>128</td>
				</tr>
				<tr>
				 <td>750    </td> <td>128</td>
				</tr>
				<tr>
				 <td>500    </td> <td>32</td>
				</tr>
				<tr>
				 <td>450    </td> <td>64</td>
				</tr>
				<tr>
				 <td>450    </td> <td>32</td>
				</tr>
				<tr>
				 <td>500    </td> <td>32</td>
				</tr>
				<tr>
				 <td>900    </td> <td>128</td>
				</tr>
			</tbody>
			
		</table>
	</p>
	<p>
		Следует отметить, что вертикальная выборка может содержать дубликаты строк в том случае, если она не содержит потенциального ключа, однозначно определяющего запись. В таблице РС потенциальным ключом является поле code. Поскольку это поле отсутствует в запросе, в приведенном выше результирующем наборе имеются дубликаты строк (например, строки 1 и 3). Если требуется получить только уникальные строки (скажем, нас интересуют только различные комбинации скорости процессора и объема памяти, а не характеристики всех имеющихся компьютеров), то можно использовать ключевое слово <b>DISTINCT</b> :
	</p>
	<p>
		<b>SELECT DISTINCT speed, ram FROM PC;</b>
	</p>
	<p>
		что даст следующий результат:
	</p>
	<p>
		<table border="1">
			<thead>
				<tr>
					<th>speed</th>
					<th>ram</th>
				</tr>
			</thead>
			<tbody>
				<tr>
				 <td>450    </td> <td>32</td>
				</tr>
				<tr>
				 <td>450    </td> <td>64</td>
				</tr>
				<tr>
				 <td>500    </td> <td>32</td>
				</tr>
				<tr>
				 <td>500    </td> <td>64</td>
				</tr>
				<tr>
				 <td>600    </td> <td>128</td>
				</tr>
				<tr>
				 <td>750    </td> <td>128</td>
				</tr>
				<tr>
				 <td>900    </td> <td>128</td>
				</tr>
			</tbody>
		</table>
	</p>
	<p>
		Помимо <b>DISTINCT</b>  может применяться также ключевое слово <b>ALL</b> (все строки), которое принимается по умолчанию.
	</p>
	<p>
		Чтобы упорядочить строки результирующего набора, можно выполнить сортировку по любому количеству полей, указанных в предложении <b>SELECT</b>. Для этого используется предложение <b>ORDER BY</b> список полей, являющееся всегда последним предложением в операторе <b>SELECT</b>. При этом в списке полей могут указываться как имена полей, так и их порядковые позиции в списке предложения <b>SELECT</b>. Так, если требуется упорядочить результирующий набор по объему оперативной памяти в порядке убывания, можно записать:
	</p>
	<p>
		<b>SELECT DISTINCT speed, ram FROM PC ORDER BY ram DESC;</b>
	</p>
	<p>или</p>
	<p>
		<b>SELECT DISTINCT speed, ram FROM PC ORDER BY 2 DESC;</b>
	</p>
	<p>
		Результат, приведенный ниже, будет, естественно, одним и тем же.
	</p>
	<p>
		<table border="1">
			<thead>
				<tr>
					<thspeed</th>
					<thram</th>
				</tr>
			</thead>
			<tbody>
				<tr>
				 <td>600 </td> <td>128</td>
				</tr>
				<tr>
				 <td>750 </td> <td>128</td>
				</tr>
				<tr>
				 <td>900 </td> <td>128</td>
				</tr>
				<tr>
				 <td>450 </td> <td>64</td>
				</tr>
				<tr>
				 <td>500 </td> <td>64</td>
				</tr>
				<tr>
				 <td>450 </td> <td>32</td>
				</tr>
				<tr>
				 <td>500 </td> <td>32</td>
				</tr>
			</tbody>
		</table>
	</p>
	<p>
		Сортировку можно проводить по возрастанию (параметр <span style="font-weight: bold;">ASC</span> принимается по умолчанию) или по убыванию (параметр <span style="font-weight: bold;">DESC</span>).
	</p>
	<div class="text_advise">
		<b>Примечание:</b>
		<p>
			Не рекомендуется в приложениях использовать запросы с сортировкой по номерам столбцов. Это связано с тем, что со временем структура таблицы может измениться, например, в результате добавления/удаления столбцов. Как следствие, запрос типа
		</p>
	</div>
	<p>
		Выполнить
	</p>
	<p>
		<b>SELECT * FROM PC ORDER BY 3;</b>
	</p>
	<p>
		может давать совсем другую последовательность или вообще вызывать ошибку, ссылаясь на отсутствующий столбец.
	</p>
	<p>
		Сортировка по двум полям
	</p>
	<p>
		<b>SELECT DISTINCT speed, ram FROM PC ORDER BY ram DESC, speed DESC;</b>
	</p>
	<p>
		даст следующий результат:
	</p>
	<p>
		<table border="1">
			<thead>
				<tr>
					<th>speed</th>
					<th>ram</th>
				</tr>
			</thead>
			<tbody>
				<tr>
				 <td>900 </td> <td>128</td>
				</tr>
				<tr>
				 <td>750 </td> <td>128</td>
				</tr>
				<tr>
				 <td>600 </td> <td>128</td>
				</tr>
				<tr>
				 <td>500 </td> <td>64</td>
				</tr>
				<tr>
				 <td>450</td> <td>64</td>
				</tr>
				<tr>
				 <td>500 </td> <td>32</td>
				</tr>
				<tr>
				 <td>450 </td> <td>32</td>
				</tr>
			</tbody>
		</table>
	</p>
	<p>
		Горизонтальную выборку реализует предложение <b>WHERE</b>  предикат, которое записывается после предложения FROM. При этом в результирующий набор попадут только те строки из источника записей, для каждой из которых значение предиката равно TRUE. То есть предикат проверяется для каждой записи. Например, запрос «получить информацию о частоте процессора и объеме оперативной памяти для компьютеров с ценой ниже $500» можно сформулировать следующим образом:
	</p>
	<p>
		<b>SELECT DISTINCT speed, ram FROM PC WHERE price < 500 ORDER BY 2 DESC;</b>
	</p>
	<p>
		<table border="1">
			<thead>
				<tr>
					<th>speed</th>
					<th>Ram</th>
				</tr>
			</thead>
			<tbody>
				<tr>
				 <td>450 </td> <td>64</td>
				</tr>
				<tr>
				 <td>450 </td> <td>32</td>
				</tr>
				<tr>
				 <td>500 </td> <td>32</td>
				</tr>
			</tbody>
		</table>
	</p>
	<p>
		В последнем запросе был применен предикат сравнения с использованием операции сравнения «<» (меньше чем). Кроме этой операции сравнения могут использоваться: «=» (равно), «>» (больше), «>=» (больше или равно), «<=» (меньше или равно) и «<>» (не равно). Выражения в предикатах сравнения могут содержать константы и любые поля из таблиц, указанных в предложении <b>FROM</b> . Символьные строки и константы типа дата/время записываются в апострофах.
	</p>
	<p>
		Примеры простых предикатов сравнения:
	</p>
	<p>
		<table border="1">
			<thead>
				<tr>
					<th>предикат</th>
					<th>описание</th>
				</tr>
			</thead>
			<tbody>
				<tr>
				 <td>price &lt; 1000 </td> <td>Цена меньше 1000</td>
				</tr>
				<tr>
				 <td>type = ‘laptop’ </td> <td>Типом продукции является портативный компьютер</td>
				</tr>
				<tr>
				 <td>cd = ‘24x’ </td> <td>24-скоростной CD-ROM</td>
				</tr>
				<tr>
				 <td>color &lt;&gt; ’y’ </td> <td>Не цветной принтер</td>
				</tr>
				<tr>
				 <td>ram – 128 &gt; 0 </td> <td>Объем оперативной памяти свыше 128 Мбайт</td>
				</tr>
				<tr>
				 <td>Price &lt;= speed*2 </td> <td>Цена не превышает удвоенной частоты процессора</td>
				</tr>
			</tbody>
		</table>
	</p>
</body>
</html>